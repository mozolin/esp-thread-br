<!DOCTYPE html>
<html lang="en-US" data-bs-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OTA Update - Thread Border Router</title>
<link href="/static/ota.min.css" type="text/css" rel="stylesheet"/>

<link href="/static/login.min.css" type="text/css" rel="stylesheet">
<script src="/static/static.min.js" defer="true"></script>
<script src="/static/restful.min.js" defer="true"></script>

<!-- dark theme -->
<script src="/static/theme-switch.min.js" defer="true"></script>
<link href="/static/ota-dark.min.css" type="text/css" rel="stylesheet">
<link href="/static/icons.min.css" type="text/css" rel="stylesheet">

</head>
<body>
  
  <!-- Overlay with login form -->
  <div id="loginOverlay" class="login-overlay">
  <div class="login-form">
    <h2><span class="open-text">Open</span><span class="thread-text">Thread</span> Border Router</h2>
    <form onsubmit="return handleLogin(event)">
    <input type="text" id="username" placeholder="Username" required>
    <input type="password" id="password" placeholder="Password" required>
    <button type="submit" class="thread-button">Login</button>
    </form>
    <p id="loginError">Invalid credentials</p>
  </div>
  </div>
  <!-- Main content (initially hidden) -->
  
  <div class="container" id="mainContent">
    <header>
      <h1>üîÑ OTA Firmware Update</h1>
      <!--
      <nav>
      	<div style="">
        <a href="/index.min.html">‚Üê Back to Main</a>
        <div class="theme-toggle" id="themeToggle">
      		<div class="compact-sun"></div>
      	</div>
      </nav>
      -->

      <nav class="navbar">
        <div class="nav-container">
        	<a href="/index.min.html" class="nav-link">&larr; Main</a>

        	<div class="theme-toggle" id="themeToggle">
            <div class="theme-icon sun-icon"></div>
            <div class="toggle-slider"></div>
            <div class="theme-icon moon-icon"></div>
          </div>

        	<a href="#" id="logout" class="nav-link" onclick="return false;">Logout &darr;</a>
        </div>
      </nav>
      
    </header>

    <div class="card">
      <h2>Device Information</h2>
      <div class="device-info">
        <div class="info-row">
          <span>Device ID:</span>
          <span id="device-id">Loading...</span>
        </div>
        <div class="info-row">
          <span>Firmware Version:</span>
          <span id="fw-version">Loading...</span>
        </div>
        <div class="info-row">
          <span>Free Heap:</span>
          <span id="free-heap">Loading...</span>
        </div>
        <div class="info-row">
          <span>Active Partition:</span>
          <span id="active-partition">Loading...</span> <!-- –≠—Ç–æ—Ç —ç–ª–µ–º–µ–Ω—Ç -->
        </div>
        <div class="info-row">
          <span>Update Partition:</span>
          <span id="update-partition">Loading...</span>
        </div>
        <div class="info-row">
          <span>Project Name:</span>
          <span id="project-name">Loading...</span>
        </div>
        <div class="info-row">
          <span>SDK Version:</span>
          <span id="sdk-version">Loading...</span>
        </div>
      </div>
    </div>

    <div class="card">
      <h2>Firmware Update</h2>
      <form id="ota-form">
        <div class="form-group">
          <label for="firmware-file" class="file-upload">
            <span class="file-icon">üìÅ</span>
            <span class="file-text">Choose firmware file (.bin)</span>
            <input type="file" id="firmware-file" accept=".bin" hidden>
          </label>
          <div id="file-info" class="file-info">No file selected</div>
        </div>

        <div class="form-group">
          <button type="submit" id="update-btn" class="btn btn-primary" disabled>
            üöÄ Start Update
          </button>
        </div>
      </form>

      <div id="progress-section" class="progress-section" style="display: none;">
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill"></div>
        </div>
        <div class="progress-text" id="progress-text">0%</div>
        <div class="progress-stats">
          <span id="uploaded-size">0 KB</span>
          <span id="total-size">0 KB</span>
        </div>
      </div>

      <div id="status-message" class="status-message"></div>
    </div>

    <div class="card warning">
      <h3>‚ö†Ô∏è Important Notes</h3>
      <ul>
        <li class="error">Do not power off the device during update</li>
        <li class="error">Ensure stable network connection</li>
        <li class="info">Update may take 2-5 minutes</li>
        <li class="info">Device will restart automatically</li>
      </ul>
    </div>
  </div>

  <script src="/static/ota.min.js"></script>
</body>
</html>
